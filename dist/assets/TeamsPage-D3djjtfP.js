import{e as re,f as rs,p as is,u as ns,r as h,j as e,B as b,C as D,a as k,b as P,d as A,m as pe,i as ls,n as cs,w as os,o as F,x as je,T as ds,y as ge}from"./index--Ct_i1hN.js";import{P as ms}from"./PageLayout-B5QyAS-9.js";import{B as H,U as Z,a as fe,F as G}from"./ComprehensiveSidebar-Vlctflbj.js";import{T as us,a as xs,b as J,c as W}from"./tabs-Ch4usXjd.js";import{u as O}from"./app-store-DSCC-9CO.js";import{A as _}from"./api-DvETopcE.js";import{D as _e,b as ve,c as ye,d as be,e as Ne,S as hs,f as ps,g as js,h as gs,i as fs,j as _s,k as vs,l as ys,m as q,o as bs,C as we,p as Te,R as Ns,T as ws,P as Ts,W as Cs,q as Ds,r as As,s as Ss,t as Ce,O as Ms}from"./dropdown-menu-M5hY8prX.js";import{I as ie}from"./input-C_7U790y.js";import{L as v}from"./label-rsT8mm_G.js";import{T as De}from"./textarea-DXjYrcOW.js";import{S}from"./switch-DycwdMRF.js";import{C as ne,A as le,a as ce,T as Ae,S as te,E as ks}from"./avatar-CiRKzmZr.js";import{P as U,E as Ps}from"./plus-YY2nQTOV.js";import{E as oe}from"./eye--OXZG_jK.js";import{U as K}from"./user-ClBJhpAm.js";import{S as de}from"./shield-C64daEXr.js";import{M as Rs}from"./mail-DfTNCLsT.js";import"./sparkles-BfGdNXHf.js";import"./index-D1ykkcZR.js";import"./index-BdQq_4o_.js";import"./index-CAJCthQj.js";import"./check-n9Ozjfd-.js";/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Is=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],$s=re("folder-open",Is);/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fs=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Se=re("user-minus",Fs);/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Es=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],ue=re("user-plus",Es),Ls={owner:{can_create_projects:!0,can_edit_projects:!0,can_delete_projects:!0,can_invite_members:!0,can_manage_members:!0,can_manage_team_settings:!0,can_export_documents:!0,can_generate_documents:!0},admin:{can_create_projects:!0,can_edit_projects:!0,can_delete_projects:!0,can_invite_members:!0,can_manage_members:!0,can_manage_team_settings:!1,can_export_documents:!0,can_generate_documents:!0},member:{can_create_projects:!0,can_edit_projects:!0,can_delete_projects:!1,can_invite_members:!1,can_manage_members:!1,can_manage_team_settings:!1,can_export_documents:!0,can_generate_documents:!0},viewer:{can_create_projects:!1,can_edit_projects:!1,can_delete_projects:!1,can_invite_members:!1,can_manage_members:!1,can_manage_team_settings:!1,can_export_documents:!0,can_generate_documents:!1}},Q=rs()(is((t,l)=>({currentTeam:null,teams:[],teamMembers:[],invitations:[],activities:[],isLoading:!1,error:null,setCurrentTeam:s=>t({currentTeam:s}),setTeams:s=>t({teams:s}),setTeamMembers:s=>t({teamMembers:s}),setInvitations:s=>t({invitations:s}),setActivities:s=>t({activities:s}),setLoading:s=>t({isLoading:s}),setError:s=>t({error:s}),addTeam:s=>t(r=>({teams:[...r.teams,s]})),updateTeam:(s,r)=>t(a=>{var o;return{teams:a.teams.map(d=>d._id===s?{...d,...r}:d),currentTeam:((o=a.currentTeam)==null?void 0:o._id)===s?{...a.currentTeam,...r}:a.currentTeam}}),removeTeam:s=>t(r=>{var a;return{teams:r.teams.filter(o=>o._id!==s),currentTeam:((a=r.currentTeam)==null?void 0:a._id)===s?null:r.currentTeam}}),addMember:s=>t(r=>({teamMembers:[...r.teamMembers,s]})),updateMember:(s,r)=>t(a=>({teamMembers:a.teamMembers.map(o=>o._id===s?{...o,...r}:o)})),removeMember:s=>t(r=>({teamMembers:r.teamMembers.filter(a=>a._id!==s)})),addInvitation:s=>t(r=>({invitations:[...r.invitations,s]})),updateInvitation:(s,r)=>t(a=>({invitations:a.invitations.map(o=>o._id===s?{...o,...r}:o)})),removeInvitation:s=>t(r=>({invitations:r.invitations.filter(a=>a._id!==s)})),addActivity:s=>t(r=>({activities:[s,...r.activities].slice(0,100)})),canUserPerformAction:(s,r)=>{const a=l();if(!a.currentTeam)return!1;const o=a.teamMembers.find(x=>x.user_id===s&&x.team_id===a.currentTeam._id&&x.status==="active");return o?(o.permissions||Ls[o.role])[r]:!1},getUserRole:s=>{const r=l();if(!r.currentTeam)return null;const a=r.teamMembers.find(o=>o.user_id===s&&o.team_id===r.currentTeam._id&&o.status==="active");return(a==null?void 0:a.role)||null},isTeamOwner:s=>{var a;return((a=l().currentTeam)==null?void 0:a.owner_id)===s},isTeamAdmin:s=>{const r=l().getUserRole(s);return r==="owner"||r==="admin"},clearTeamData:()=>t({currentTeam:null,teams:[],teamMembers:[],invitations:[],activities:[],isLoading:!1,error:null})}),{name:"team-store",partialize:t=>({currentTeam:t.currentTeam,teams:t.teams})})),X=()=>{const{user:t,isAuthenticated:l,isLoading:s}=ns();return{auth:{user:t?{uid:t.uid,name:t.name||t.email||"User",email:t.email||"",...t}:null,isAuthenticated:l,isLoading:s}}};function Us({open:t,onOpenChange:l,onTeamCreated:s}){const[r,a]=h.useState(!1),[o,d]=h.useState({name:"",description:""}),[x,p]=h.useState({allow_member_invites:!0,require_approval_for_projects:!1,default_project_visibility:"team",notification_preferences:{project_updates:!0,new_members:!0,document_generation:!0,mentions:!0,email_notifications:!1}}),{auth:c}=X(),{addNotification:u}=O(),N=async i=>{if(i.preventDefault(),!!c.user){if(!o.name.trim()){u({type:"error",title:"Validation Error",message:"Team name is required"});return}a(!0);try{const n={name:o.name.trim(),description:o.description.trim(),owner_id:c.user.uid,settings:x,status:"active"};await _.createTeam(n),await _.logActivity({team_id:"",user_id:c.user.uid,action_type:"team_created",resource_type:"team",resource_id:"",details:{user_name:c.user.name,team_name:n.name}});const f={_id:Date.now().toString(),_uid:c.user.uid,_tid:"",...n,created_at:Date.now()};s(f),u({type:"success",title:"Team Created",message:`${o.name} team has been created successfully`}),d({name:"",description:""}),p({allow_member_invites:!0,require_approval_for_projects:!1,default_project_visibility:"team",notification_preferences:{project_updates:!0,new_members:!0,document_generation:!0,mentions:!0,email_notifications:!1}})}catch(n){console.error("Failed to create team:",n),u({type:"error",title:"Creation Failed",message:"Failed to create team. Please try again."})}finally{a(!1)}}},M=(i,n)=>{d(f=>({...f,[i]:n}))},C=(i,n)=>{p(f=>({...f,[i]:n}))},y=(i,n)=>{p(f=>({...f,notification_preferences:{...f.notification_preferences,[i]:n}}))};return e.jsx(_e,{open:t,onOpenChange:l,children:e.jsxs(ve,{className:"sm:max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs(ye,{children:[e.jsx(be,{children:"Create New Team"}),e.jsx(Ne,{children:"Set up a new team to collaborate on MVP projects with your colleagues."})]}),e.jsxs("form",{onSubmit:N,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(v,{htmlFor:"name",children:"Team Name *"}),e.jsx(ie,{id:"name",value:o.name,onChange:i=>M("name",i.target.value),placeholder:"Enter team name",maxLength:50,required:!0})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"description",children:"Description"}),e.jsx(De,{id:"description",value:o.description,onChange:i=>M("description",i.target.value),placeholder:"Describe your team's purpose and goals",maxLength:200,rows:3})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Team Settings"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(v,{className:"text-sm",children:"Allow member invitations"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Members can invite others to join the team"})]}),e.jsx(S,{checked:x.allow_member_invites,onCheckedChange:i=>C("allow_member_invites",i)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(v,{className:"text-sm",children:"Require project approval"}),e.jsx("p",{className:"text-xs text-gray-600",children:"New projects need admin approval"})]}),e.jsx(S,{checked:x.require_approval_for_projects,onCheckedChange:i=>C("require_approval_for_projects",i)})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Default Notifications"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(v,{className:"text-sm",children:"Project updates"}),e.jsx(S,{checked:x.notification_preferences.project_updates,onCheckedChange:i=>y("project_updates",i)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(v,{className:"text-sm",children:"New members"}),e.jsx(S,{checked:x.notification_preferences.new_members,onCheckedChange:i=>y("new_members",i)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(v,{className:"text-sm",children:"Document generation"}),e.jsx(S,{checked:x.notification_preferences.document_generation,onCheckedChange:i=>y("document_generation",i)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(v,{className:"text-sm",children:"Email notifications"}),e.jsx(S,{checked:x.notification_preferences.email_notifications,onCheckedChange:i=>y("email_notifications",i)})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx(b,{type:"button",variant:"outline",onClick:()=>l(!1),children:"Cancel"}),e.jsx(b,{type:"submit",disabled:r,children:r?"Creating...":"Create Team"})]})]})]})})}function Os({open:t,onOpenChange:l,teamId:s,onInvitationSent:r}){const[a,o]=h.useState(!1),[d,x]=h.useState(""),[p,c]=h.useState("member"),{auth:u}=X(),{addNotification:N}=O(),{getUserRole:M}=Q(),C=u.user?M(u.user.uid):null,y=async n=>{if(n.preventDefault(),!u.user)return;if(!d.trim()||!p){N({type:"error",title:"Validation Error",message:"Please fill in all required fields"});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d.trim())){N({type:"error",title:"Invalid Email",message:"Please enter a valid email address"});return}o(!0);try{const w=Date.now()+6048e5,V=await _.createInvitation({team_id:s,email:d.trim().toLowerCase(),role:p,invited_by:u.user.uid,expires_at:w,status:"pending"});await _.logActivity({team_id:s,user_id:u.user.uid,action_type:"member_invited",resource_type:"member",resource_id:V,details:{user_name:u.user.name,invited_email:d.trim(),role:p}}),N({type:"success",title:"Invitation Sent",message:`Team invitation sent to ${d.trim()}`}),x(""),c("member"),r()}catch(w){console.error("Failed to send invitation:",w),N({type:"error",title:"Invitation Failed",message:"Failed to send team invitation. Please try again."})}finally{o(!1)}},i=[{value:"viewer",label:"Viewer",description:"Can view projects and documents but cannot edit or create"},{value:"member",label:"Member",description:"Can create and edit projects, generate documents"},...C==="owner"?[{value:"admin",label:"Admin",description:"Can manage members and have full project access"}]:[]];return e.jsx(_e,{open:t,onOpenChange:l,children:e.jsxs(ve,{className:"sm:max-w-md",children:[e.jsxs(ye,{children:[e.jsx(be,{children:"Invite Team Member"}),e.jsx(Ne,{children:"Send an invitation to join your team. They'll receive an email with instructions."})]}),e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(v,{htmlFor:"email",children:"Email Address *"}),e.jsx(ie,{id:"email",type:"email",value:d,onChange:n=>x(n.target.value),placeholder:"colleague@company.com",required:!0})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"role",children:"Role *"}),e.jsxs(hs,{value:p,onValueChange:n=>c(n),children:[e.jsx(ps,{children:e.jsx(js,{placeholder:"Select a role"})}),e.jsx(gs,{children:i.map(n=>e.jsx(fs,{value:n.value,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:n.label}),e.jsx("span",{className:"text-xs text-gray-600",children:n.description})]})},n.value))})]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Note:"})," The invitation will expire in 7 days. The invited person will need to create an account or sign in to accept the invitation."]})}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx(b,{type:"button",variant:"outline",onClick:()=>l(!1),children:"Cancel"}),e.jsx(b,{type:"submit",disabled:a,children:a?"Sending...":"Send Invitation"})]})]})]})})}const xe={owner:ne,admin:de,member:K,viewer:oe},he={owner:"bg-purple-100 text-purple-800",admin:"bg-blue-100 text-blue-800",member:"bg-green-100 text-green-800",viewer:"bg-gray-100 text-gray-800"},ae={owner:"Owner",admin:"Admin",member:"Member",viewer:"Viewer"};function Vs({teamId:t,members:l,onMembersUpdate:s}){const[r,a]=h.useState(!1),[o,d]=h.useState([]),[x,p]=h.useState(!1),{auth:c}=X(),{addNotification:u}=O(),{canUserPerformAction:N,isTeamOwner:M,getUserRole:C}=Q(),y=c.user?N(c.user.uid,"can_invite_members"):!1,i=c.user?N(c.user.uid,"can_manage_members"):!1;c.user&&M(c.user.uid);const n=c.user?C(c.user.uid):null;h.useEffect(()=>{f()},[t]);const f=async()=>{try{const m=await _.getTeamInvitations(t);d(m.filter(g=>g.status==="pending"))}catch(m){console.error("Failed to load invitations:",m)}},w=async(m,g)=>{if(c.user)try{p(!0);const T=l.find(j=>j._id===m);if(!T)return;await _.updateTeamMember({_uid:T._uid,_id:T._id,role:g}),await _.logActivity({team_id:t,user_id:c.user.uid,action_type:"member_role_changed",resource_type:"member",resource_id:m,details:{user_name:c.user.name,old_role:T.role,new_role:g}}),u({type:"success",title:"Role Updated",message:`Member role changed to ${ae[g]}`}),s()}catch(T){console.error("Failed to update role:",T),u({type:"error",title:"Update Failed",message:"Failed to update member role"})}finally{p(!1)}},V=async m=>{if(c.user&&confirm("Are you sure you want to remove this member from the team?"))try{p(!0);const g=l.find(T=>T._id===m);if(!g)return;await _.removeTeamMember(g._uid,g._id),await _.logActivity({team_id:t,user_id:c.user.uid,action_type:"member_left",resource_type:"member",resource_id:m,details:{user_name:c.user.name}}),u({type:"success",title:"Member Removed",message:"Member has been removed from the team"}),s()}catch(g){console.error("Failed to remove member:",g),u({type:"error",title:"Removal Failed",message:"Failed to remove member from team"})}finally{p(!1)}},ee=async m=>{if(c.user)try{const g=o.find(T=>T._id===m);if(!g)return;await _.updateInvitation({_uid:g._uid,_id:g._id,status:"revoked"}),u({type:"success",title:"Invitation Revoked",message:"Team invitation has been cancelled"}),f()}catch(g){console.error("Failed to revoke invitation:",g),u({type:"error",title:"Revocation Failed",message:"Failed to revoke invitation"})}},z=m=>m.substring(0,2).toUpperCase(),se=m=>!c.user||!n||m.user_id===c.user.uid||m.role==="owner"||m.role==="admin"&&n!=="owner"?!1:i;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Team Members"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage team members and their permissions"})]}),y&&e.jsxs(b,{onClick:()=>a(!0),className:"gap-2",children:[e.jsx(U,{className:"h-4 w-4"}),"Invite Member"]})]}),e.jsxs(D,{children:[e.jsx(k,{children:e.jsxs(P,{className:"text-base",children:["Active Members (",l.length,")"]})}),e.jsx(A,{children:e.jsx("div",{className:"space-y-4",children:l.map(m=>{var j;const g=xe[m.role],T=m.user_id===((j=c.user)==null?void 0:j.uid);return e.jsxs("div",{className:"flex items-center justify-between py-3 border-b last:border-b-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(le,{className:"h-10 w-10",children:e.jsx(ce,{className:"text-sm",children:z(m.user_id)})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-medium",children:[m.user_id,T&&e.jsx("span",{className:"text-sm text-gray-500",children:"(You)"})]}),e.jsxs(H,{className:he[m.role],children:[e.jsx(g,{className:"h-3 w-3 mr-1"}),ae[m.role]]})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Joined ",new Date(m.joined_at).toLocaleDateString()]})]})]}),!T&&se(m)&&e.jsxs(_s,{children:[e.jsx(vs,{asChild:!0,children:e.jsx(b,{variant:"ghost",size:"sm",children:e.jsx(Ps,{className:"h-4 w-4"})})}),e.jsxs(ys,{align:"end",children:[n==="owner"&&m.role!=="admin"&&e.jsxs(q,{onClick:()=>w(m._id,"admin"),children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Make Admin"]}),n==="owner"&&m.role==="admin"&&e.jsxs(q,{onClick:()=>w(m._id,"member"),children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Make Member"]}),(m.role==="member"||m.role==="viewer")&&e.jsxs(e.Fragment,{children:[m.role!=="viewer"&&e.jsxs(q,{onClick:()=>w(m._id,"viewer"),children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Make Viewer"]}),m.role!=="member"&&e.jsxs(q,{onClick:()=>w(m._id,"member"),children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Make Member"]})]}),e.jsx(bs,{}),e.jsxs(q,{onClick:()=>V(m._id),className:"text-red-600",children:[e.jsx(Se,{className:"h-4 w-4 mr-2"}),"Remove from Team"]})]})]})]},m._id)})})})]}),o.length>0&&e.jsxs(D,{children:[e.jsx(k,{children:e.jsxs(P,{className:"text-base",children:["Pending Invitations (",o.length,")"]})}),e.jsx(A,{children:e.jsx("div",{className:"space-y-4",children:o.map(m=>{const g=xe[m.role];return e.jsxs("div",{className:"flex items-center justify-between py-3 border-b last:border-b-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-100 flex items-center justify-center",children:e.jsx(Rs,{className:"h-5 w-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:m.email}),e.jsxs(H,{className:he[m.role],children:[e.jsx(g,{className:"h-3 w-3 mr-1"}),ae[m.role]]})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Invited ",new Date(m.invited_at).toLocaleDateString()," • Expires ",new Date(m.expires_at).toLocaleDateString()]})]})]}),i&&e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>ee(m._id),className:"text-red-600 hover:text-red-700",children:e.jsx(Ae,{className:"h-4 w-4"})})]},m._id)})})})]}),e.jsx(Os,{open:r,onOpenChange:a,teamId:t,onInvitationSent:()=>{f(),a(!1)}})]})}const qs={project_created:U,project_updated:G,project_deleted:G,document_generated:G,document_updated:G,member_invited:ue,member_joined:ue,member_left:Se,member_role_changed:ne,team_settings_updated:fe,team_created:Z},Hs={project_created:"bg-green-100 text-green-800",project_updated:"bg-blue-100 text-blue-800",project_deleted:"bg-red-100 text-red-800",document_generated:"bg-purple-100 text-purple-800",document_updated:"bg-purple-100 text-purple-800",member_invited:"bg-yellow-100 text-yellow-800",member_joined:"bg-green-100 text-green-800",member_left:"bg-red-100 text-red-800",member_role_changed:"bg-blue-100 text-blue-800",team_settings_updated:"bg-gray-100 text-gray-800",team_created:"bg-green-100 text-green-800"},zs={project_created:"Created Project",project_updated:"Updated Project",project_deleted:"Deleted Project",document_generated:"Generated Document",document_updated:"Updated Document",member_invited:"Invited Member",member_joined:"Joined Team",member_left:"Left Team",member_role_changed:"Role Changed",team_settings_updated:"Updated Settings",team_created:"Created Team"};function Ys({activities:t}){const l=a=>a.substring(0,2).toUpperCase(),s=a=>{const{action_type:o,details:d}=a,x=d.user_name||a.user_id;switch(o){case"project_created":return`${x} created project "${d.project_name||"Untitled"}"`;case"project_updated":return`${x} updated project "${d.project_name||"Untitled"}"`;case"project_deleted":return`${x} deleted project "${d.project_name||"Untitled"}"`;case"document_generated":return`${x} generated ${d.document_type||"document"} for "${d.project_name||"project"}"`;case"document_updated":return`${x} updated ${d.document_type||"document"} for "${d.project_name||"project"}"`;case"member_invited":return`${x} invited ${d.invited_email||"someone"} to join as ${d.role||"member"}`;case"member_joined":return`${x} joined the team`;case"member_left":return`${x} left the team`;case"member_role_changed":return`${x} changed role from ${d.old_role||"unknown"} to ${d.new_role||"unknown"}`;case"team_settings_updated":return`${x} updated team settings`;case"team_created":return`${x} created the team`;default:return`${x} performed an action`}},r=a=>{const d=Date.now()-a,x=Math.floor(d/1e3),p=Math.floor(x/60),c=Math.floor(p/60),u=Math.floor(c/24);return u>0?`${u} day${u>1?"s":""} ago`:c>0?`${c} hour${c>1?"s":""} ago`:p>0?`${p} minute${p>1?"s":""} ago`:"Just now"};return t.length===0?e.jsx(D,{children:e.jsxs(A,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(we,{className:"h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Activity Yet"}),e.jsx("p",{className:"text-gray-600 text-center max-w-md",children:"Team activity will appear here as members create projects, generate documents, and collaborate."})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Recent Activity"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track team collaboration and project updates"})]}),e.jsx(D,{children:e.jsx(A,{className:"p-0",children:e.jsx("div",{className:"divide-y",children:t.map(a=>{const o=qs[a.action_type];return e.jsx("div",{className:"p-4 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(le,{className:"h-8 w-8 mt-1",children:e.jsx(ce,{className:"text-xs",children:l(a.user_id)})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs(H,{className:Hs[a.action_type],children:[e.jsx(o,{className:"h-3 w-3 mr-1"}),zs[a.action_type]]}),e.jsx("span",{className:"text-xs text-gray-500",children:r(a.timestamp)})]}),e.jsx("p",{className:"text-sm text-gray-900",children:s(a)}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(a.timestamp).toLocaleString()})]})]})},a._id)})})})})]})}var Me="AlertDialog",[Bs,It]=ls(Me,[Te]),R=Te(),ke=t=>{const{__scopeAlertDialog:l,...s}=t,r=R(l);return e.jsx(Ns,{...r,...s,modal:!0})};ke.displayName=Me;var Gs="AlertDialogTrigger",Pe=h.forwardRef((t,l)=>{const{__scopeAlertDialog:s,...r}=t,a=R(s);return e.jsx(ws,{...a,...r,ref:l})});Pe.displayName=Gs;var Js="AlertDialogPortal",Re=t=>{const{__scopeAlertDialog:l,...s}=t,r=R(l);return e.jsx(Ts,{...r,...s})};Re.displayName=Js;var Ws="AlertDialogOverlay",Ie=h.forwardRef((t,l)=>{const{__scopeAlertDialog:s,...r}=t,a=R(s);return e.jsx(Ms,{...a,...r,ref:l})});Ie.displayName=Ws;var L="AlertDialogContent",[Zs,Ks]=Bs(L),Qs=os("AlertDialogContent"),$e=h.forwardRef((t,l)=>{const{__scopeAlertDialog:s,children:r,...a}=t,o=R(s),d=h.useRef(null),x=pe(l,d),p=h.useRef(null);return e.jsx(Cs,{contentName:L,titleName:Fe,docsSlug:"alert-dialog",children:e.jsx(Zs,{scope:s,cancelRef:p,children:e.jsxs(Ds,{role:"alertdialog",...o,...a,ref:x,onOpenAutoFocus:cs(a.onOpenAutoFocus,c=>{var u;c.preventDefault(),(u=p.current)==null||u.focus({preventScroll:!0})}),onPointerDownOutside:c=>c.preventDefault(),onInteractOutside:c=>c.preventDefault(),children:[e.jsx(Qs,{children:r}),e.jsx(et,{contentRef:d})]})})})});$e.displayName=L;var Fe="AlertDialogTitle",Ee=h.forwardRef((t,l)=>{const{__scopeAlertDialog:s,...r}=t,a=R(s);return e.jsx(As,{...a,...r,ref:l})});Ee.displayName=Fe;var Le="AlertDialogDescription",Ue=h.forwardRef((t,l)=>{const{__scopeAlertDialog:s,...r}=t,a=R(s);return e.jsx(Ss,{...a,...r,ref:l})});Ue.displayName=Le;var Xs="AlertDialogAction",Oe=h.forwardRef((t,l)=>{const{__scopeAlertDialog:s,...r}=t,a=R(s);return e.jsx(Ce,{...a,...r,ref:l})});Oe.displayName=Xs;var Ve="AlertDialogCancel",qe=h.forwardRef((t,l)=>{const{__scopeAlertDialog:s,...r}=t,{cancelRef:a}=Ks(Ve,s),o=R(s),d=pe(l,a);return e.jsx(Ce,{...o,...r,ref:d})});qe.displayName=Ve;var et=({contentRef:t})=>{const l=`\`${L}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${L}\` by passing a \`${Le}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${L}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return h.useEffect(()=>{var r;document.getElementById((r=t.current)==null?void 0:r.getAttribute("aria-describedby"))||console.warn(l)},[l,t]),null},st=ke,tt=Pe,at=Re,He=Ie,ze=$e,Ye=Oe,Be=qe,Ge=Ee,Je=Ue;const rt=st,it=tt,nt=at,We=h.forwardRef(({className:t,...l},s)=>e.jsx(He,{className:F("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...l,ref:s}));We.displayName=He.displayName;const Ze=h.forwardRef(({className:t,...l},s)=>e.jsxs(nt,{children:[e.jsx(We,{}),e.jsx(ze,{ref:s,className:F("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...l})]}));Ze.displayName=ze.displayName;const Ke=({className:t,...l})=>e.jsx("div",{className:F("flex flex-col space-y-2 text-center sm:text-left",t),...l});Ke.displayName="AlertDialogHeader";const Qe=({className:t,...l})=>e.jsx("div",{className:F("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...l});Qe.displayName="AlertDialogFooter";const Xe=h.forwardRef(({className:t,...l},s)=>e.jsx(Ge,{ref:s,className:F("text-lg font-semibold",t),...l}));Xe.displayName=Ge.displayName;const es=h.forwardRef(({className:t,...l},s)=>e.jsx(Je,{ref:s,className:F("text-sm text-muted-foreground",t),...l}));es.displayName=Je.displayName;const ss=h.forwardRef(({className:t,...l},s)=>e.jsx(Ye,{ref:s,className:F(je(),t),...l}));ss.displayName=Ye.displayName;const ts=h.forwardRef(({className:t,...l},s)=>e.jsx(Be,{ref:s,className:F(je({variant:"outline"}),"mt-2 sm:mt-0",t),...l}));ts.displayName=Be.displayName;function lt({team:t,onTeamUpdate:l}){const[s,r]=h.useState(!1),[a,o]=h.useState({name:t.name,description:t.description}),[d,x]=h.useState(t.settings),{auth:p,addNotification:c}=O(),u=async()=>{if(p.user){if(!a.name.trim()){c({type:"error",title:"Validation Error",message:"Team name is required"});return}r(!0);try{const n={_uid:t._uid,_id:t._id,name:a.name.trim(),description:a.description.trim()};await _.updateTeam(n),await _.logActivity({team_id:t._id,user_id:p.user.uid,action_type:"team_settings_updated",resource_type:"team",resource_id:t._id,details:{user_name:p.user.name,changes:"General information"}}),l(n),c({type:"success",title:"Settings Saved",message:"Team information has been updated"})}catch(n){console.error("Failed to update team:",n),c({type:"error",title:"Update Failed",message:"Failed to update team settings"})}finally{r(!1)}}},N=async()=>{if(p.user){r(!0);try{const n={_uid:t._uid,_id:t._id,settings:d};await _.updateTeam(n),await _.logActivity({team_id:t._id,user_id:p.user.uid,action_type:"team_settings_updated",resource_type:"team",resource_id:t._id,details:{user_name:p.user.name,changes:"Team permissions and notifications"}}),l(n),c({type:"success",title:"Settings Saved",message:"Team settings have been updated"})}catch(n){console.error("Failed to update settings:",n),c({type:"error",title:"Update Failed",message:"Failed to update team settings"})}finally{r(!1)}}},M=async()=>{if(p.user){r(!0);try{await _.deleteTeam(t._uid,t._id),c({type:"success",title:"Team Deleted",message:"Team has been permanently deleted"}),window.location.href="/teams"}catch(n){console.error("Failed to delete team:",n),c({type:"error",title:"Deletion Failed",message:"Failed to delete team. Please try again."})}finally{r(!1)}}},C=(n,f)=>{o(w=>({...w,[n]:f}))},y=(n,f)=>{x(w=>({...w,[n]:f}))},i=(n,f)=>{x(w=>({...w,notification_preferences:{...w.notification_preferences,[n]:f}}))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Team Settings"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage team information, permissions, and preferences"})]}),e.jsxs(D,{children:[e.jsx(k,{children:e.jsx(P,{className:"text-base",children:"General Information"})}),e.jsxs(A,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(v,{htmlFor:"team-name",children:"Team Name *"}),e.jsx(ie,{id:"team-name",value:a.name,onChange:n=>C("name",n.target.value),placeholder:"Enter team name",maxLength:50})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"team-description",children:"Description"}),e.jsx(De,{id:"team-description",value:a.description,onChange:n=>C("description",n.target.value),placeholder:"Describe your team's purpose and goals",maxLength:200,rows:3})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(b,{onClick:u,disabled:s,children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Save Changes"]})})]})]}),e.jsxs(D,{children:[e.jsx(k,{children:e.jsx(P,{className:"text-base",children:"Team Permissions"})}),e.jsxs(A,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(v,{className:"text-sm",children:"Allow member invitations"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Team members can invite others to join the team"})]}),e.jsx(S,{checked:d.allow_member_invites,onCheckedChange:n=>y("allow_member_invites",n)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(v,{className:"text-sm",children:"Require project approval"}),e.jsx("p",{className:"text-xs text-gray-600",children:"New projects need admin approval before becoming active"})]}),e.jsx(S,{checked:d.require_approval_for_projects,onCheckedChange:n=>y("require_approval_for_projects",n)})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(b,{onClick:N,disabled:s,children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Save Settings"]})})]})]}),e.jsxs(D,{children:[e.jsx(k,{children:e.jsx(P,{className:"text-base",children:"Default Notifications"})}),e.jsxs(A,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(v,{className:"text-sm",children:"Project updates"}),e.jsx(S,{checked:d.notification_preferences.project_updates,onCheckedChange:n=>i("project_updates",n)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(v,{className:"text-sm",children:"New members"}),e.jsx(S,{checked:d.notification_preferences.new_members,onCheckedChange:n=>i("new_members",n)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(v,{className:"text-sm",children:"Document generation"}),e.jsx(S,{checked:d.notification_preferences.document_generation,onCheckedChange:n=>i("document_generation",n)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(v,{className:"text-sm",children:"Mentions"}),e.jsx(S,{checked:d.notification_preferences.mentions,onCheckedChange:n=>i("mentions",n)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(v,{className:"text-sm",children:"Email notifications"}),e.jsx(S,{checked:d.notification_preferences.email_notifications,onCheckedChange:n=>i("email_notifications",n)})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(b,{onClick:N,disabled:s,children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Save Notifications"]})})]})]}),e.jsxs(D,{className:"border-red-200",children:[e.jsx(k,{children:e.jsx(P,{className:"text-base text-red-600",children:"Danger Zone"})}),e.jsx(A,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-red-600",children:"Delete Team"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Permanently delete this team and all associated data. This action cannot be undone."})]}),e.jsxs(rt,{children:[e.jsx(it,{asChild:!0,children:e.jsxs(b,{variant:"destructive",className:"gap-2",children:[e.jsx(Ae,{className:"h-4 w-4"}),"Delete Team"]})}),e.jsxs(Ze,{children:[e.jsxs(Ke,{children:[e.jsxs(Xe,{className:"flex items-center gap-2",children:[e.jsx(ds,{className:"h-5 w-5 text-red-600"}),"Delete Team"]}),e.jsxs(es,{children:['Are you sure you want to delete "',t.name,'"? This will permanently remove:',e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"All team members and invitations"}),e.jsx("li",{children:"Team activity history"}),e.jsx("li",{children:"Team settings and preferences"})]}),e.jsx("strong",{className:"block mt-2 text-red-600",children:"This action cannot be undone."})]})]}),e.jsxs(Qe,{children:[e.jsx(ts,{children:"Cancel"}),e.jsx(ss,{onClick:M,className:"bg-red-600 hover:bg-red-700",disabled:s,children:s?"Deleting...":"Delete Team"})]})]})]})]})})]})]})}function ct({teamId:t}){const l=ge(),[s,r]=h.useState([]),[a,o]=h.useState(!0),{auth:d}=O(),{canUserPerformAction:x}=Q(),p=d.user?x(d.user.uid,"can_create_projects"):!1;h.useEffect(()=>{c()},[t]);const c=async()=>{try{o(!0);const i=await _.getTeamProjects(t);r(i)}catch(i){console.error("Failed to load team projects:",i)}finally{o(!1)}},u=()=>{l("/dashboard",{state:{openCreateDialog:!0,teamId:t}})},N=i=>{l(`/project/${i._id}`)},M=i=>{switch(i){case"active":return"bg-green-100 text-green-800";case"completed":return"bg-blue-100 text-blue-800";case"draft":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},C=i=>{switch(i){case"active":return"Active";case"completed":return"Completed";case"draft":return"Draft";default:return"Unknown"}},y=i=>i.substring(0,2).toUpperCase();return a?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Team Projects"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Collaborative MVP projects created by team members"})]}),p&&e.jsxs(b,{onClick:u,className:"gap-2",children:[e.jsx(U,{className:"h-4 w-4"}),"New Project"]})]}),s.length===0?e.jsx(D,{children:e.jsxs(A,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx($s,{className:"h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Projects Yet"}),e.jsx("p",{className:"text-gray-600 text-center max-w-md mb-6",children:p?"Create your first team project to start collaborating on MVP development.":"Team projects will appear here once members start creating them."}),p&&e.jsxs(b,{onClick:u,className:"gap-2",children:[e.jsx(U,{className:"h-4 w-4"}),"Create Team Project"]})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(i=>e.jsxs(D,{className:"hover:shadow-md transition-shadow cursor-pointer group",children:[e.jsx(k,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(P,{className:"text-base font-semibold truncate group-hover:text-primary transition-colors",children:i.name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:i.industry})]}),e.jsx(H,{className:M(i.status),children:C(i.status)})]})}),e.jsx(A,{className:"pt-0",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm text-gray-700 line-clamp-2",children:i.problem_statement}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(we,{className:"h-3 w-3"}),e.jsx("span",{children:new Date(i.updated_at).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(le,{className:"h-4 w-4",children:e.jsx(ce,{className:"text-xs",children:y(i._uid)})}),e.jsx("span",{className:"truncate max-w-20",children:i._uid})]})]}),e.jsx("div",{className:"flex gap-2 pt-2",children:e.jsxs(b,{size:"sm",onClick:()=>N(i),className:"flex-1 gap-1",children:[e.jsx(ks,{className:"h-3 w-3"}),"Open Project"]})})]})})]},i._id))}),s.length>0&&e.jsxs(D,{children:[e.jsx(k,{children:e.jsx(P,{className:"text-base",children:"Project Statistics"})}),e.jsx(A,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:s.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Projects"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:s.filter(i=>i.status==="active").length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Active"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:s.filter(i=>i.status==="completed").length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Completed"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:s.filter(i=>i.status==="draft").length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Drafts"})]})]})})]})]})}const ot={owner:ne,admin:de,member:K,viewer:oe},dt={owner:"bg-purple-100 text-purple-800",admin:"bg-blue-100 text-blue-800",member:"bg-green-100 text-green-800",viewer:"bg-gray-100 text-gray-800"};function mt(){const t=ge(),[l,s]=h.useState(!1),[r,a]=h.useState("projects"),[o,d]=h.useState(!0),{auth:x}=X(),{addNotification:p}=O(),{teams:c,currentTeam:u,teamMembers:N,activities:M,setTeams:C,setCurrentTeam:y,setTeamMembers:i,setActivities:n,getUserRole:f,isTeamOwner:w,canUserPerformAction:V}=Q();h.useEffect(()=>{ee()},[]),h.useEffect(()=>{u&&z()},[u]);const ee=async()=>{if(x.user)try{d(!0);const j=await _.getTeamsByOwner(x.user.uid),$=(await _.getUserTeams(x.user.uid)).map(B=>B.team_id),Y=(await _.getTeams()).filter(B=>$.includes(B._id)&&!j.find(as=>as._id===B._id)),E=[...j,...Y];C(E),E.length>0&&!u&&y(E[0])}catch(j){console.error("Failed to load teams:",j)}finally{d(!1)}},z=async()=>{if(u)try{const[j,I]=await Promise.all([_.getTeamMembers(u._id),_.getTeamActivities(u._id,20)]);i(j),n(I)}catch(j){console.error("Failed to load team data:",j)}},se=j=>{y(j),a("projects")},m=()=>{s(!0)},g=j=>{C([j,...c]),y(j),s(!1)};x.user&&f(x.user.uid),x.user&&w(x.user.uid);const T=x.user?V(x.user.uid,"can_manage_team_settings"):!1;return o?e.jsx("div",{className:"flex items-center justify-center min-h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Team Collaboration"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your teams and collaborate on MVP projects"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(b,{variant:"outline",onClick:()=>t("/dashboard"),children:"Back to Projects"}),e.jsxs(b,{onClick:m,className:"gap-2",children:[e.jsx(U,{className:"h-4 w-4"}),"Create Team"]})]})]}),c.length===0?e.jsx(D,{children:e.jsxs(A,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(Z,{className:"h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Teams Yet"}),e.jsx("p",{className:"text-gray-600 text-center max-w-md mb-6",children:"Create your first team to start collaborating on MVP projects with your colleagues."}),e.jsxs(b,{onClick:m,className:"gap-2",children:[e.jsx(U,{className:"h-4 w-4"}),"Create Your First Team"]})]})}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(D,{children:[e.jsx(k,{children:e.jsx(P,{className:"text-lg",children:"Your Teams"})}),e.jsx(A,{className:"space-y-2",children:c.map(j=>{var Y;const I=N.filter(E=>E.team_id===j._id&&E.status==="active").length,$=f(((Y=x.user)==null?void 0:Y.uid)||""),me=ot[$||"viewer"];return e.jsxs("div",{className:`p-3 rounded-lg border cursor-pointer transition-colors ${(u==null?void 0:u._id)===j._id?"border-primary bg-primary/5":"border-gray-200 hover:border-gray-300"}`,onClick:()=>se(j),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:j.name}),e.jsxs(H,{className:dt[$||"viewer"],children:[e.jsx(me,{className:"h-3 w-3 mr-1"}),$]})]}),e.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[e.jsx(Z,{className:"h-3 w-3 mr-1"}),I," member",I!==1?"s":""]})]},j._id)})})]})}),e.jsx("div",{className:"lg:col-span-3",children:u?e.jsxs(D,{children:[e.jsx(k,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-xl",children:u.name}),e.jsx("p",{className:"text-gray-600 mt-1",children:u.description})]}),T&&e.jsxs(b,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(fe,{className:"h-4 w-4"}),"Settings"]})]})}),e.jsx(A,{children:e.jsxs(us,{value:r,onValueChange:a,children:[e.jsxs(xs,{className:"grid w-full grid-cols-4",children:[e.jsx(J,{value:"projects",children:"Projects"}),e.jsx(J,{value:"members",children:"Members"}),e.jsx(J,{value:"activity",children:"Activity"}),T&&e.jsx(J,{value:"settings",children:"Settings"})]}),e.jsx(W,{value:"projects",className:"mt-6",children:e.jsx(ct,{teamId:u._id})}),e.jsx(W,{value:"members",className:"mt-6",children:e.jsx(Vs,{teamId:u._id,members:N.filter(j=>j.team_id===u._id),onMembersUpdate:z})}),e.jsx(W,{value:"activity",className:"mt-6",children:e.jsx(Ys,{activities:M.filter(j=>j.team_id===u._id)})}),T&&e.jsx(W,{value:"settings",className:"mt-6",children:e.jsx(lt,{team:u,onTeamUpdate:j=>{const I={...u,...j};y(I),C(c.map($=>$._id===u._id?I:$))}})})]})})]}):e.jsx(D,{children:e.jsx(A,{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Select a Team"}),e.jsx("p",{className:"text-gray-600",children:"Choose a team from the sidebar to view details"})]})})})})]}),e.jsx(Us,{open:l,onOpenChange:s,onTeamCreated:g})]})}function $t(){return e.jsx(ms,{children:e.jsx(mt,{})})}export{$t as TeamsPage};
